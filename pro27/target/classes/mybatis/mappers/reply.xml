<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- mapper.memberというnamespaceでSQLクエリを設定 -->
<mapper namespace="mapper.reply">
	<resultMap id="reResult" type="replyVO">
		<result property="replyNO" column="replyNO" />
		<result property="articleNO" column="articleNO" />
		<result property="writerID" column="writerID" />
		<result property="r_content" column="r_content" />
		<result property="r_date" column="r_date" />
	</resultMap>
	
<!-- 	articleNOにあたるコメントを呼ぶ -->
	<select id="selectReply" resultMap="reResult" parameterType="int">
		<![CDATA[
      SELECT * from t_reply
      where articleNO = #{articleNO}	
      ORDER BY replyNO DESC	
    ]]>
	</select>
	
<!-- 	コメント作成 -->
	<insert id="insertNewReply" parameterType="java.util.Map">
		<![CDATA[
			INSERT into t_reply(replyNO,  articleNO, writerID, r_content)
			VALUES(#{replyNO}, #{articleNO}, #{writerID}, #{r_content})
		]]>
	</insert>
	
<!-- 	新しいコメントのrepもらうOをもらう -->
	<select id="selectNewReplyNO" resultType="int" parameterType="int">
		<![CDATA[
			SELECT max(replyNO)+1 from t_reply	
			where articleNO = #{articleNO}
		]]>
	</select>
	
<!-- 	コメント削除 -->
	<delete id="deleteReply" parameterType="int">
    <![CDATA[
      delete from t_reply
      where 
      replyNO = #{replyNO} 
    ]]>
	</delete>
	

</mapper>